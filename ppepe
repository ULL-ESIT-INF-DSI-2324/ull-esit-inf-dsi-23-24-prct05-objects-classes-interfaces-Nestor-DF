import { Alimento } from "./Alimento";
import { Bebida } from "./Bebida";

/**
 * Clase nevera
 */
export class Nevera {
  alimentos: Alimento[];
  bebidas: Bebida[];
  listaCompra: (Alimento | Bebida)[];

  constructor() {
    this.alimentos = [];
    this.bebidas = [];
    this.listaCompra = [];
  }

  /**
   * Función que añade un alimento a a lisa de alimentos, si está aumenta la cantidad
   * @param alimento alimento a ser añadido
   */
  aniadirAlimento(alimento: Alimento) {
    if (this.alimentos.find((value) => value.nombre === alimento.nombre) !== undefined) {
      this.alimentos.forEach((item) => {
        if (item.nombre === alimento.nombre) {
          item.cantidad++;
        }
      });
    } else {
      this.alimentos.push(alimento);
    }
  }

  /**
   * Función que añade una bebida a a lista de bebidas, si está aumenta la cantidad
   * @param bebida bebida a ser añadida
   */
  aniadirBebida(bebida: Bebida) {
    if (this.bebidas.find((value) => value.nombre === bebida.nombre) !== undefined) {
      this.bebidas.forEach((item) => {
        if (item.nombre === bebida.nombre) {
          item.cantidadLitros++;
        }
      });
    } else {
      this.bebidas.push(bebida);
    }
  }

  /**
   * Función que quita un alimento a a lista de alimentos, si está disminuye la cantidad
   * Si se llega a cantidad 0 la añade a la lista de la compra
   * @param alimento alimento a ser quitado
   */
  consumirAlimento(alimento: Alimento) {
    if (this.alimentos.find((value) => value.nombre === alimento.nombre) === undefined) {
      console.log("No existe");
    }
    if (alimento.cantidad > 1) {
      alimento.cantidad--;
    } else {
      alimento.cantidad--;
      this.aniadirAListaCompra(alimento);
    }
  }

  /**
   * Función que quita una bebida a a lista de bebidas, si está disminuye la cantidad
   * Si se llega a cantidad 0 la añade a la lista de la compra
   * @param bebida bebida a ser quitada
   */
  consumirBebida(bebida: Bebida) {
    if (this.bebidas.find((value) => value.nombre === bebida.nombre) === undefined) {
      console.log("No existe");
    }
    if (bebida.cantidadLitros > 1) {
      bebida.cantidadLitros--;
    } else {
      bebida.cantidadLitros--;
      this.aniadirAListaCompra(bebida);
    }
  }

  private aniadirAListaCompra(item: Alimento | Bebida) {
    this.listaCompra.push(item);
  }

  ListaCompra(): string {
    const lista = this.listaCompra.map((item) => item.nombre);
    return lista.join(", ");
  }
}
